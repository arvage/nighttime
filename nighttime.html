<script type="text/x-red" data-template-name="nighttime-credentials">
    <div id="node-config-nighttime-app-keys">
        <div class="form-row">
            <p style="margin-top: 10px;"><b>1.</b> <span>Register to get your key at </span> <a href="https://darksky.net/dev/" target="_blank" style="text-decoration:underline;">Dark Sky</a>.</p>
        </div>
        <div class="form-row">
            <p style="margin-top: 10px;"><b>2.</b> <span>Copy the key here and give it a name:</span>:</p>
        </div>
        <div class="form-row">
            <label style="margin-left: 10px; margin-right: -10px;" for="node-config-input-key_identifier"><i class="fa fa-user"></i> <span>Name</span></label>
            <input type="text" id="node-config-input-key_identifier">
        </div>
        <div class="form-row">
            <label style="margin-left: 10px; margin-right: -10px;" for="node-config-input-client_key"><i class="fa fa-key"></i> <span>Key</span></label>
            <input type="password" id="node-config-input-client_key">
        </div>
    </div>
</script>

<script type="text/javascript">
(function() {
    RED.nodes.registerType('nighttime-credentials',{
        category: 'config',
        defaults: {
            key_identifier: {value:""}
        },
        credentials: {
            key_identifier: {type:"text"},
            client_key: { type:"password"}
        },
        label: function() { return this.key_identifier; },
        exportable: false
    });
})();
</script>

<script type="text/x-red" data-template-name="nighttime">
    <div class="form-row">
        <label for="node-input-nighttime"><i class="fa fa-user"></i> <span>Credentials</span></label>
        <input type="text" id="node-input-nighttime">
    </div>
    <div class="form-row" id="weather-coordinates">
        <label for=""><i class="fa fa-location-arrow"></i> <span>Latitude</span></label>
        <input type="text" class="weather-location-input" id="node-input-lat" style="width: 180px; margin-bottom: 7px" placeholder="Latitude">
        </br>
        <label for=""><i class="fa fa-location-arrow"></i> <span>Longitude</span></label>
        <input type="text" class="weather-location-input" id="node-input-lon" style="width: 180px" placeholder="Longitude">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> <span>Name</span></label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <p style="margin-top: 10px;"<span>To get your lat long coordinates go to:  </span> <a href="https://www.latlong.net/" target="_blank" style="text-decoration:underline;">www.latlong.net</a>.</p>
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('nighttime',{
        category: 'input',
        color: '#7AA0D2',
        defaults: {
            nighttime: {type:"nighttime-credentials",required:true},
	    name: {value: "nighttime"},
            lon: {value:"", validate:function(v) {return ((v>=-180) && (v<=180));} },
            lat: {value:"", validate:function(v) {return ((v>=-90) && (v<=90));} },
        },
        inputs:0,
        outputs:1,
        icon: "weather.png",
        label: function() { 
		return this.name || "nighttime";}
    });
</script>

<script type="text/x-red" data-help-name="nighttime">
    <p>A simple node indicating if it's day or night.</p>
    <p>The node sets: <code>msg.payload</code> to boolean "true" or "false" payloads.</p>
    <p>The node checks every 2 minutes if current time and date is bigger than todays sunset and less than tomorrow's sunrise times.</p>
    <p>it sends a "true" payload if it is dark and "false" if not dark.</p>
    <p>This is done using DarkSky API and with latitude and longitude set of coordinates.</p>
    <p>You need to open free account on DarkSky.net and get an API key in order to make this node working.</p>
    <p>Powered by the <a href="https://darksky.net/poweredby/" target="_blank">Dark Sky Forecast API</a>.</p>
</script>
